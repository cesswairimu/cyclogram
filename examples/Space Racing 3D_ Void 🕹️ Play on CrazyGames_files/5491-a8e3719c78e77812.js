"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5491],{32157:function(e,t,i){i.d(t,{v:function(){return Z},Z:function(){return N}});var s,n,r=i(85893),a=i(67294),o=i(46413);class d{constructor(e){this.id=e,this.previousTimeInView=0,this.isInView=!1,this.isInFocus=!0,this.isHidden=!1,this.inViewSince=Date.now(),this.inDOMSince=this.inViewSince}setHidden(e){this.isHidden=e}canRefresh(e,t){return this.isInView&&this.isInFocus&&this.totalTimeInView()>=e&&this.totalTimeInDOM()>=t}refreshed(){this.previousTimeInView=0,this.inViewSince=Date.now(),this.inDOMSince=this.inViewSince}cameIntoView(){this.isInView=!0,this.inViewSince=Date.now()}removedFromView(){this.isInView=!1,this.updateTimeInView()}pageLostFocus(){this.isInFocus=!1,this.isInView&&this.updateTimeInView()}pageRegainedFocus(){this.isInFocus=!0,this.isInView&&(this.inViewSince=Date.now())}updateTimeInView(){let e=Date.now()-this.inViewSince;this.previousTimeInView+=e,this.inViewSince=Date.now()}totalTimeInDOM(){return Date.now()-this.inDOMSince}totalTimeInView(){return this.isInView?this.previousTimeInView+Date.now()-this.inViewSince:this.previousTimeInView}}var l=class{constructor(e,t,i){this.viewportThreshold=e,this.minimumTimeInViewInMs=t,this.minimumTimeinDOMInMs=i,this.handleVisibilityChange=()=>{let e=document[this.hiddenKey],t=o.Z.isFullscreen()||o.Z.isFakeFullscreen();e||t?this.pageLostFocus():this.pageRegainedFocus()},this.handleFullscreenChange=()=>{let e=o.Z.isFullscreen()||o.Z.isFakeFullscreen();e?this.pageLostFocus():this.pageRegainedFocus()},this.adUnits=[],this.setVisibilityKeys(),this.observer=this.createObserver(),this.installEventListeners(),this.pageFocusChangeCallBacks=[],this.ioCallbackPending=[],this.ioCallbackPendingPromise=null,this.ioCallbackPendingResolve=null}addElement(e){if(this.adUnits.find(t=>t.id===e))return;let t=this.getElementById(e);t&&(this.ioCallbackPending.push(e),this.adUnits.push(new d(e)),this.observer.observe(t.parentElement))}removeElement(e,t){this.adUnits=this.adUnits.filter(t=>t.id!==e),t&&this.observer.unobserve(t.parentElement),this.removeWaitingForCallbackElement(e)}addPageFocusChangeCallback(e){this.pageFocusChangeCallBacks.push(e)}stop(){this.adUnits=[],this.pageFocusChangeCallBacks=[],this.observer.disconnect(),this.removeEventListeners()}unitsReadyForRefresh(){return this.adUnits.filter(e=>e.canRefresh(this.minimumTimeInViewInMs,this.minimumTimeinDOMInMs))}waitForObservedUnitsCallbacks(){return this.ioCallbackPendingPromise||(this.ioCallbackPendingPromise=new Promise(e=>{this.ioCallbackPendingResolve=e,0===this.ioCallbackPending.length&&e()})),this.ioCallbackPendingPromise}isUnitHidden(e){let t=this.adUnits.find(t=>t.id===e);return!t||t.isHidden}canUnitRefresh(e){let t=this.adUnits.find(t=>t.id===e);return!t||t.canRefresh(this.minimumTimeInViewInMs,this.minimumTimeinDOMInMs)}refreshedUnits(e){e.map(e=>this.getObservedUnit(e)).map(e=>e.refreshed())}intersectionCallback(e){e.forEach(e=>{let t=e.target.firstElementChild.id,i=this.getObservedUnit(t);e.intersectionRatio>=this.viewportThreshold?i.cameIntoView():i.removedFromView(),i.setHidden(this.isEntryHidden(e)),this.removeWaitingForCallbackElement(t)})}isEntryHidden(e){let{boundingClientRect:t}=e;return this.isBoundingRectHidden(t)}isBoundingRectHidden(e){return 0===e.height&&0===e.width}getElementById(e){let t=document.getElementById(e);return t||(console.error(`[AdObserver] could not find element with id ${e}`),null)}getObservedUnit(e){let t=this.adUnits.find(t=>t.id===e);if(!t)throw Error("[AdObserver] observed unit not found");return t}pageLostFocus(){this.adUnits.map(e=>e.pageLostFocus()),this.invokeCallBacks(!1)}pageRegainedFocus(){this.adUnits.map(e=>e.pageRegainedFocus()),this.invokeCallBacks(!0)}invokeCallBacks(e){this.pageFocusChangeCallBacks.forEach(t=>t(e))}createObserver(){return new IntersectionObserver((e,t)=>{this.intersectionCallback(e)},{threshold:[this.viewportThreshold]})}installEventListeners(){document.addEventListener(this.visibilityChangeKey,this.handleVisibilityChange,!1),this.installFullscreenListener()}removeEventListeners(){document.removeEventListener(this.visibilityChangeKey,this.handleVisibilityChange),this.removeFullscreenListeners()}installFullscreenListener(){o.Z.addFullscreenListener(this.handleFullscreenChange),o.Z.addFakeFullscreenListener(this.handleFullscreenChange)}removeFullscreenListeners(){o.Z.removeFullscreenListener(this.handleFullscreenChange),o.Z.removeFakeFullscreenListener(this.handleFullscreenChange)}setVisibilityKeys(){void 0!==document.hidden?(this.hiddenKey="hidden",this.visibilityChangeKey="visibilitychange"):void 0!==document.msHidden?(this.hiddenKey="msHidden",this.visibilityChangeKey="msvisibilitychange"):void 0!==document.webkitHidden&&(this.hiddenKey="webkitHidden",this.visibilityChangeKey="webkitvisibilitychange")}removeWaitingForCallbackElement(e){this.ioCallbackPending=this.ioCallbackPending.filter(t=>t!==e),0===this.ioCallbackPending.length&&this.ioCallbackPendingResolve&&(this.ioCallbackPendingResolve(),this.ioCallbackPendingResolve=null)}},h=i(69626),c=i(46313),u=i(34769);let m=new class{constructor(){this.loadingPromise=null,this.loadListeners=[],this.isLoaded=!1}adsLoaded(){return this.isLoaded}loadCrazyAds(e){if(!this.loadingPromise){if(e.shouldDisableAds())this.loadingPromise=Promise.resolve();else{let e=c.Z.Instance.data.advertizing.bundle;this.loadingPromise=(0,u.Z)(e,!0)}this.loadingPromise.then(()=>{this.finishedLoading()})}return this.loadingPromise}addOnLoadListener(e){this.loadListeners.push(e),this.isLoaded&&this.invokeListener(e)}removeLoadListener(e){this.loadListeners=this.loadListeners.filter(t=>e===t)}finishedLoading(){this.isLoaded=!0,this.loadListeners.forEach(e=>{this.invokeListener(e)})}invokeListener(e){try{e()}catch(e){console.error("[AdsLoader] error calling listener",e.message)}}};var g=i(84973),f=i(7057),p=i(58104),w=i(55933),v=i(3708),b=class{constructor(e){this.onRefresh=e,this.timeBetweenRefreshesInMs=51e3,this.refreshTimeRemainingInMs=this.timeBetweenRefreshesInMs,this.gameplayStarted=!1,this.timeLastRefreshed=0}isLowEndHelper(){return!1}isSmartHelper(){return!1}isDefaultHelper(){return!1}initRefreshHelper(){}resetRefreshHelper(){}refresh(){let e=this.onRefresh();(e||this.refreshTimeRemainingInMs<=0)&&(this.refreshTimeRemainingInMs=this.timeBetweenRefreshesInMs,this.timeLastRefreshed=Date.now()),this.startRefreshTimer()}requestAdsFinished(){this.timeLastRefreshed=Date.now()}startRefreshTimer(){if(this.refreshTimeRemainingInMs<=0){this.refresh();return}this.refreshTimerStartedAt=Date.now(),this.refreshTimer=window.setTimeout(()=>{this.refreshTimeRemainingInMs=0,this.refresh()},this.refreshTimeRemainingInMs)}stopRefreshTimer(){if(this.refreshTimer){clearTimeout(this.refreshTimer);let e=Date.now()-this.refreshTimerStartedAt;this.refreshTimeRemainingInMs=this.refreshTimeRemainingInMs-e}}resetRefreshTimer(e){let t=this.timeBetweenRefreshesInMs;void 0!==e&&(t=Math.max(e,0)),this.refreshTimer&&clearTimeout(this.refreshTimer),this.refreshTimerStartedAt=Date.now(),this.refreshTimeRemainingInMs=t}},C=i(89950),I=class extends b{constructor(e,t){super(e),this.smartRefresh=t,this.refreshTimeRemainingInMs=t.minWaitInMs||3e4}isSmartHelper(){return!0}refresh=()=>{let e=this.onRefresh();(e||this.refreshTimeRemainingInMs<=0)&&(this.gameplayStarted?this.refreshTimeRemainingInMs=this.smartRefresh.maxWaitInMs||18e4:this.refreshTimeRemainingInMs=this.smartRefresh.minWaitInMs||3e4,this.timeLastRefreshed=Date.now()),this.startRefreshTimer()};initRefreshHelper=()=>{super.initRefreshHelper(),window.addEventListener("message",this.handleMessage)};resetRefreshHelper=()=>{super.resetRefreshHelper(),window.removeEventListener("message",this.handleMessage)};requestAdsFinished(){super.requestAdsFinished(),this.startRefreshTimer()}handleMessage=e=>{if(e.data&&e.data.type===C.V)switch(e.data.event){case"adFinished":case"gameplayStart":{if(this.gameplayStarted)return;this.gameplayStarted=!0;let e=this.smartRefresh.maxWaitInMs||18e4;this.resetRefreshTimer(e),this.startRefreshTimer();break}case"rewardedAd":case"midgameAd":case"gameplayStop":{if(!this.gameplayStarted)return;this.gameplayStarted=!1;let e=Date.now()-this.timeLastRefreshed,t=(this.smartRefresh.minWaitInMs||3e4)-e;this.resetRefreshTimer(t),this.startRefreshTimer()}}}},y=i(4235),k=class extends b{initRefreshHelper(){super.initRefreshHelper(),this.timeInitCalled=Date.now(),window.addEventListener("message",this.handleMessage),y.$()?.contentWindow?.postMessage("check-loading-state","*")}resetRefreshHelper(){super.resetRefreshHelper(),window.removeEventListener("message",this.handleMessage)}handleMessage=e=>{if(e.data&&e.data.type===C.V&&(e.data?.event==="gameFinishedLoading"||e.data?.event==="gameLoadingStateResponse"&&e.data.success)){let e=Date.now(),t=e-this.timeInitCalled;t>45e3?this.refresh():(this.refreshTimeRemainingInMs=Math.max(0,this.timeBetweenRefreshesInMs-t),this.startRefreshTimer())}}},F=class extends b{isDefaultHelper(){return!0}requestAdsFinished(){super.requestAdsFinished(),this.startRefreshTimer()}},T=i(28584),R=i(78966),A=i(95570),x=i(22120),L=i(74040),U=i(13301),S=i(83514);let M=[{width:1910,height:970},{width:1360,height:660},{width:1370,height:650},{width:1370,height:620},{width:1530,height:750},{width:1360,height:650},{width:1910,height:940},{width:1370,height:660},{width:1360,height:630},{width:1080,height:710},{width:1920,height:970},{width:1360,height:620},{width:1910,height:960},{width:1370,height:670},{width:1530,height:710},{width:1910,height:930},{width:1370,height:630},{width:1920,height:940},{width:390,height:660}];var D=i(92975),E=i(57632),P=i(10029);let O=null;var H=i(58752),V=i(33209),B=i(93988);function q(){throw Error("[AdContext] No Advertising Context")}let Z=a.createContext({addAdUnit:e=>q(),removeAdUnit:(e,t)=>q(),adblock:!1});(s=n||(n={})).ANDROID="android",s.IOS="ios",s.WINDOWS="windows",s.MAC="macos",s.LINUX="linux",s.CHROMIUM="chromiumos",s.UBUNTU="ubuntu",s.UNKNOWN="unknown",s.OTHER="other";let W={GB:.2,US:.2},_=["army","battle-royale","battleship","bloody","bomberman","cannon","first-person-shooter","gta","gun","horde-survival","hunting","jump-scare","killing","mmo","police","scary","shooting","sniper","soldier","surgery","survive","tank","third-person-shooter","war"],j=null;class z extends a.Component{static isFirstRequest=!0;countryCode=null;deviceInfo=null;disabledCountries=["RU","VE","BY"];bidderAttemptsWithoutBid={};biddersToDisable={};constructor(e){super(e),this.adUnits=[],this.timeInViewInMs=1e4,this.viewPortThreshold=.5,this.observer=null,this.loadingState="loadingAds",this.lowendRefreshControl=.05>Math.random()}componentDidMount(){let{pageUrlHelper:e,smartRefresh:t}=this.props,i=42e3;if(t.enabled){let e=t.minWaitInMs||3e4;i=e-2e3}this.timeInDomInMs=i,this.loadingState="loadingAds",this.observer=new l(this.viewPortThreshold,this.timeInViewInMs,this.timeInDomInMs),this.firstPageRequest=!0,this.userType=(0,H.OQ)()?"returning":"new",this.cmp().addInstallListener(this.onCMPInstalled);let s=e.shouldDisableAds()||this.props.disabled||!this.props.deviceType.isDesktop;s||(m.loadCrazyAds(e).then(()=>{z.isFirstRequest||window.CrazygamesAds.reset()}),this.props.services.adUnitService.getAdUnitsConfig().then(e=>{this.adConfig=e,this.toWaitingConfig()}),m.addOnLoadListener(this.onAdsLoaded)),this.resetBiddersToDisableInterval=window.setInterval(()=>{this.resetBiddersToDisable()},9e5)}componentWillUnmount(){this.loadingState="loadingAds",this.observer&&(this.stopObserving(),this.observer=null),this.cmp().removeConsentListener(this.onCMPConsented),this.cmp().removeInstallListener(this.onCMPInstalled);let{pageUrlHelper:e}=this.props;e.shouldDisableAds()||m.removeLoadListener(this.onAdsLoaded),this.getRefreshHelper()?.resetRefreshHelper();let t=window;t.CrazygamesAds&&t.CrazygamesAds.nextPage&&t.CrazygamesAds.nextPage(),window.clearInterval(this.resetBiddersToDisableInterval)}render(){return(0,r.jsx)(Z.Provider,{value:{addAdUnit:this.addAdUnit,removeAdUnit:this.removeAdUnit,adblock:!1},children:this.props.children})}getCountryCode=()=>this.countryCode;onCMPInstalled=()=>{this.toCMPLoading()};onCMPConsented=()=>{this.toWaitForConsent()};onAdsLoaded=()=>{"loadingAds"===this.loadingState&&(this.loadingState="waitingAdconfig",this.initAds(),this.toWaitingConfig())};initAds(){window.CrazygamesAds.initAds(),this.props.services.crazyAnalyticsService.adsFinishedLoading(),this.props.services.analyticsService.checkAdblock()}toWaitingConfig(){"waitingAdconfig"===this.loadingState&&this.adConfig&&(this.loadingState="waitingCountry",this.toWaitingCountry())}async toWaitingCountry(){if("waitingCountry"===this.loadingState&&!this.countryCode){let{services:e}=this.props,{userInfoService:t}=e,i=await t.getUserInfo();this.countryCode=i.countryCode,this.deviceInfo=i.device,!this.inDisabledCountry(i.countryCode)&&(this.initRefreshHelper(),"waitingCountry"===this.loadingState&&(this.shouldWaitUntilConsented()&&this.cmp().addConsentListener(this.onCMPConsented),this.loadingState="loadingCMP",this.toCMPLoading()))}}inDisabledCountry(e){return!e||this.disabledCountries.some(t=>t===e)}toCMPLoading(){"loadingCMP"===this.loadingState&&(!(0,v.Z)(this.getCountryCode(),this.props.pageUrlHelper)||this.cmp().isInstalled())&&(this.loadingState="waitConsent",this.toWaitForConsent())}toWaitForConsent(){"waitConsent"===this.loadingState&&(this.shouldWaitUntilConsented()?this.cmp().userHasConsented()&&(this.loadingState="requestingAds",this.addUnitsToObserver(),this.toRequestAds()):(this.loadingState="requestingAds",this.addUnitsToObserver(),this.toRequestAds()))}async toRequestAds(){"requestingAds"===this.loadingState&&(await this.requestAds(),"requestingAds"===this.loadingState&&(this.addObserverCallbacks(),this.loadingState="finished"))}addAdUnit=e=>{!this.adUnits.find(t=>t.id===e.id)&&(this.adUnits.push(e),this.observer&&this.adConfig&&this.addUnitToObserver(e))};removeAdUnit=(e,t)=>{this.adUnits=this.adUnits.filter(t=>t.id!==e.id),this.observer&&this.adConfig&&this.removeUnitFromObserver(e,t)};async requestAds(){let e=this.adUnitsRequestConfig();if(0!==e.length&&(await this.observer.waitForObservedUnitsCallbacks(),"requestingAds"===this.loadingState))return this.requestAndRenderAds()}requestAndRenderAds=()=>{let e;if(!this.observer)return!1;e=this.firstPageRequest?this.adUnits.filter(e=>!this.observer.isUnitHidden(e.id)):this.adUnits.filter(e=>this.observer.canUnitRefresh(e.id));let t=e.map(e=>e.id),i=this.adUnitsRequestConfig();if(0===i.length||0===t.length)return!0;let s={units:i,codes:t},n=window.CrazygamesAds;if(void 0===n)return!1;let r=this.requestAdsOptions();return n.requestOnly(s,r).then(async e=>{if("loadingAds"===this.loadingState)return;let i=this.renderAds(t);if(e)for(let i of t){let t=this.getBiddersToConsiderForAdUnit(i,s,r);this.updateBidderAttemptsWithoutBid(i,e,t),delete this.biddersToDisable[i]}await i}).catch(e=>console.error(e)),this.firstPageRequest&&(this.firstPageRequest=!1,z.isFirstRequest=!1,this.getRefreshHelper()?.requestAdsFinished()),!0};requestAdsOptions(){let{dollarRate:e,priceFloor:t,...i}=this.adConfig.advertising,s=this.getTimeout(),n=this.adConfig.bidders.map(e=>this.mapApiConfigToBidderConfig(e)),r=this.isLoggedIn(),a=(()=>{let e=this.getPriceFloor()||t;return r&&(this.floorExperimentFactor=this.props.services.experimentService.getExperimentValueSync(B.So),this.floorExperimentFactor&&e)?e*Number(this.floorExperimentFactor):e})(),o=this.getUserDetails(),d=window.location.origin+window.location.pathname;return{...i,priceFloor:()=>a,bidders:n,dollarRate:e,timeout:s,trafficSource:this.trafficSource(),user:o,pageUrl:d,ortb2Site:this.ortb2SiteConfig(d),clientInfo:{country:this.getCountryCode(),domain:(0,V.Ld)((0,V.Jx)(this.props.pageUrlHelper.routeData.hostname)),browser:this.deviceInfo?.browser.name?.toLowerCase().replace(/\s/g,""),device:(0,U.l7)(this.props.deviceType)}}}ortb2SiteConfig(e){let t=(this.props.advertisingGame.tagsSlug||[]).filter(e=>-1===_.indexOf(e)),i={title:this.props.advertisingGame.gameName,url:window.location.href,context:2,userrating:`${this.props.advertisingGame.numLikes}`,sourcerelationship:1,keywords:t.join(",")};return{page:e,content:i}}async renderAds(e){try{let t=this.renderAdsOptions();await window.CrazygamesAds.render(e,t)}catch(e){console.error(e)}}renderAdsOptions(){let{dollarRate:e}=this.adConfig.advertising,t=this.getTimeout(),i=this.adConfig.bidders.find(e=>"google"===e.id),s=i?{googleBidder:{...this.mapApiConfigToBidderConfig(i),enabled:!0}}:{};return{dollarRate:e,dfp:this.dfpKeys(),banner:{callback:e=>{let{minPrice:t}=e;!function(e,t){if(t){if(null===O){let t=window.setTimeout(()=>{e.bannerAdConversion(O?.totalValue||0),function(){if("undefined"==typeof gtag||!O||!O.totalValue)return;let e=O.totalValue;(0,P.requestIdleCallback)(()=>{gtag("event","conversion",{send_to:"AW-312835820/UBOSCNjR06wDEOz9lZUB",value:e,currency:"EUR"})},{timeout:2e3}),(0,f.YD)()&&(0,P.requestIdleCallback)(()=>{gtag("event","purchase",{allow_custom_scripts:!0,currency:"EUR",value:e,quantity:1,transaction_id:(0,E.Z)(),send_to:"DC-13034049/rev0/crazy0+items_sold"})},{timeout:2e3})}(),O=null},1e3);O={timeoutId:t,totalValue:0}}O.totalValue=O.totalValue+t}}(this.props.services.crazyAnalyticsService,t)}},requestTimeout:t,...s}}trafficSource(){let e=(0,f.p9)();return e?"purchased":"organic"}getPriceFloor(){let e=this.getCountryCode();return e&&W[e]||null}getTimeout(){return z.isFirstRequest?2400:2e3}mapApiConfigToBidderConfig(e){let t={bidder:e.id,...e.config};return"adsense"===e.id?{...t,enabled:!1}:{enabled:!0,...t}}pageFocusChangeCallback=e=>{this.getRefreshHelper()?.stopRefreshTimer(),e&&"finished"===this.loadingState&&this.getRefreshHelper()?.refresh()};adUnitsRequestConfig(){let{units:e}=this.adConfig,t=this.adUnits.map(t=>{let i=e.find(e=>e.id===t.code);if(!i)return console.error(`[Advertising] Unexpected code ${t.code}`),null;let s=this.getBiddersToDisable(t.id),n=i.config.request.bidders,r=n.map(e=>s.includes(e.bidder)?{...e,enabled:!1}:e);return{adUnit:{mediaTypes:i.definition.mediaTypes,code:t.id},slotId:i.definition.slotId,...i.config.request,bidders:r}});return t.filter(e=>!!e)}addUnitsToObserver(){this.adUnits.forEach(e=>{this.addUnitToObserver(e)})}addObserverCallbacks(){this.observer.addPageFocusChangeCallback(this.pageFocusChangeCallback)}addUnitToObserver(e){let t=this.getUnitDefinition(e.code);if(!t){console.error("Missing definition",e.code);return}this.observer.addElement(e.id)}removeUnitFromObserver(e,t){let i=this.getUnitDefinition(e.code);if(!i){console.error("Missing definition",e.code);return}i.definition.refresh&&this.observer.removeElement(e.id,t)}stopObserving(){this.observer.stop(),this.observer=null,this.getRefreshHelper()?.stopRefreshTimer()}dfpKeys(){let e,t;let{pageUrlHelper:i,advertisingGame:s}=this.props,{gameSlug:n,tagsSlug:r,categoryEnSlug:a}=s,o=i.routeData.hostname,d=(0,f.FM)(),l=(0,f.dj)();if(l){let i=Date.now(),s=l.date,n=(0,T.Z)(i,s)+1;e=`${l.adGroup}_week${n}`;let r=(0,R.Z)(s)+1,a=r<10?`0${r}`:`${r}`,o=`${(0,A.Z)(s)}`.slice(-2);t=`${l.adGroup}_${a}_${o}`}let h=this.mapOsToDfpOs(this.deviceInfo?.os.name),c=this.isLoggedIn();return{domain:o,advertising_campaign:d,pwa:`${(0,w.rQ)()}`,category_slug:a,game_slug:n,tags_slug:r.length>0?r:void 0,ad_group:e,ad_group_month:t,logged_in:`${c}`,user_type:this.userType,os:h,...function(){let e=window.innerWidth,t=window.innerHeight,i=M.some(i=>i.width===e&&i.height===t);if(i)return{browser_size:`${e}x${t}`}}(),gamepage_exp4_24:void 0===this.props.gamepage_exp4_24?void 0:`${this.props.gamepage_exp4_24}`,...c&&!!this.floorExperimentFactor&&{[B.So]:`${this.floorExperimentFactor}`}}}isLoggedIn(){return!!this.props.userContext.user}mapOsToDfpOs(e){if(!e)return n.UNKNOWN;let t=e.toLowerCase().replace(/\s/g,"");switch(t){case"android":return n.ANDROID;case"ios":return n.IOS;case"windows":return n.WINDOWS;case"macos":return n.MAC;case"linux":return n.LINUX;case"chromiumos":return n.CHROMIUM;case"ubuntu":return n.UBUNTU;default:return n.OTHER}}shouldWaitUntilConsented(){return(0,p.I)(this.getCountryCode())}getUnitDefinition(e){let t=this.adConfig.units.find(t=>t.id===e);return t}getRefreshHelper(){return this.refreshHelper||this.initRefreshHelper(),this.refreshHelper}initRefreshHelper(){if(!this.deviceInfo)return;let{smartRefresh:e}=this.props,t=this.requestAndRenderAds;e&&e.enabled?this.refreshHelper=new I(t,e):this.props.device.isLowEndDevice&&!this.lowendRefreshControl?this.refreshHelper=new k(t):this.refreshHelper=new F(t),this.refreshHelper.initRefreshHelper()}getUserEmail(){if(this.email)return this.email;let{userContext:e}=this.props,{user:t,loadingUser:i}=e;if(i)return;let s=t?.email?.trim().toLowerCase().replace(/\+[^@]*@/g,"@");return this.email=s,this.email}getUserDetails(){var e;let t=this.getUserEmail();return{email:t,amazon:{applicable:(e=this.deviceInfo,null===j&&(j=!!e&&["Firefox","Safari","Mobile Safari"].some(t=>(0,U.jU)(e?.browser,t))),j)},uid2:{applicable:!0}}}cmp(){return(0,h.a)()}getBiddersToDisable(e){let t=this.bidderAttemptsWithoutBid[e];if(!this.biddersToDisable[e]){if(t){let i=Object.keys(t),s=i.filter(e=>t[e]>=5);this.biddersToDisable[e]=s}else this.biddersToDisable[e]=[]}return this.biddersToDisable[e]}resetBiddersToDisable(){this.bidderAttemptsWithoutBid={},this.biddersToDisable={}}getBiddersToConsiderForAdUnit(e,t,i){let s={};(i.bidders||[]).forEach(e=>{s[e.bidder]={...e}});let n=t.units.find(t=>t.adUnit.code===e)?.bidders||[];return n.forEach(e=>{s[e.bidder]={...s[e.bidder],...e}}),Object.values(s).filter(e=>e.enabled&&"google"!==e.bidder).map(e=>e.bidder)}updateBidderAttemptsWithoutBid(e,t,i){this.bidderAttemptsWithoutBid[e]=this.bidderAttemptsWithoutBid[e]||{};let s=(t[e]?.bids??[]).map(e=>e.bidder);i.forEach(t=>{s.includes(t)?this.bidderAttemptsWithoutBid[e][t]=0:this.bidderAttemptsWithoutBid[e][t]=(this.bidderAttemptsWithoutBid[e][t]||0)+1})}}var N=(0,D.Z)((0,g.Z)(function(e){let t=t=>{let{pageUrlHelper:i}=a.useContext(S.t);return(0,r.jsx)(e,{pageUrlHelper:i,...t})};return t}((0,x.Z)(function(e){let t=t=>{let i=a.useContext(L.S);return(0,r.jsx)(e,{userContext:i,...t})};return t}(z)))))},32184:function(e,t,i){i.d(t,{f:function(){return u}});var s=i(85893),n=i(50319),r=i(73359),a=i(67294),o=i(74040),d=i(17670),l=i(69311),h=i(37899),c=i(23500);let u=a.createContext({loading:!1,addScore:()=>{}}),m=e=>{let{gameId:t,children:i}=e,{user:m,loadingUser:g}=a.useContext(o.S),[f]=(0,n.D)(d.HL),[p,w]=(0,a.useState)(),[v,b]=(0,a.useState)(),{services:C}=a.useContext(h.Z),I=C?.userInfoService,[y,{loading:k,data:F,error:T,stopPolling:R,startPolling:A}]=(0,r.t)(d.wS,{variables:{gameId:t,before:0,after:0},fetchPolicy:"network-only",notifyOnNetworkStatusChange:!0,onCompleted:e=>{if(!m||!e.ranking[0])return;let t={score:e.ranking[0].score,position:e.ranking[0].position};if(t.score===p?.score&&t.position===p?.position)return;let i=!!v&&v.score>t.score;i||w(t)}});a.useEffect(()=>{if(!m){w(void 0),R();return}y(),(0,l.nb)()||A(l.SZ)},[y,A,R,m]),a.useEffect(()=>{if(!m||!v||!F&&!T)return;let e=async()=>{if(T||F&&0===F.ranking.length||v.score>F.ranking[0].score){let e=await f({variables:{input:{encryptedScore:v.encryptedScore,gameId:t}}}),i=e.data?.addScore;i&&w({score:i.score,position:i.position})}};e(),b(void 0)},[t,v,m,F,T,f]);let x=async(e,i)=>{if(t!==l.FZ){console.error("This game doesn't support user score.");return}if((0,l.nb)()){console.error("Game challenge is over.");return}if(!m){(!v||v.score<e)&&b({score:e,encryptedScore:i});return}if(p&&e<=p.score)return;let s=await f({variables:{input:{encryptedScore:i,gameId:t}}}),n=s.data?.addScore;n&&(I&&p&&n.score>p.score&&(0,c.Z)(I),w({score:n.score,position:n.position}))};return(0,s.jsx)(u.Provider,{value:{userScore:p,loading:k||g,addScore:x},children:i})};t.Z=m},18288:function(e,t,i){var s=i(85893),n=i(9008),r=i.n(n);i(67294);var a=i(46313),o=i(50513),d=i(33209);let l="favicons/manifest-icon-3.png",h="favicons/favicon.ico",c=e=>{let{title:t,metaDescription:i,canonical:n,alternatives:c=[],children:u}=e,m=c.find(e=>{let{locale:t}=e;return t===d.ZW}),g=(e,t,i)=>(0,o.ZP)(e,{w:t,h:i,fit:"crop",crop:"entropy"}),f="development"===a.Z.Instance.environment;return(0,s.jsxs)(r(),{children:[(0,s.jsx)("title",{children:`${f?"\uD83E\uDD99 - ":""}${t}`}),(0,s.jsx)("link",{rel:"manifest",href:"/manifest"}),(0,s.jsx)("meta",{httpEquiv:"Accept-CH",content:"DPR"}),(0,s.jsx)("meta",{name:"description",content:i}),n&&(0,s.jsx)("link",{rel:"canonical",href:n}),c.map(e=>{let{href:t,locale:i}=e,n=(0,d.xi)(i);return(0,s.jsx)("link",{rel:"alternate",hrefLang:n,href:t},n)}),m&&(0,s.jsx)("link",{rel:"alternate",href:m.href,hrefLang:"x-default"}),(0,s.jsx)("meta",{name:"theme-color",content:"#ffffff"}),(0,s.jsx)("meta",{name:"HandheldFriendly",content:"true"}),(0,s.jsx)("meta",{name:"mobile-web-app-capable",content:"yes"}),(0,s.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"yes"}),(0,s.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"default"}),(0,s.jsx)("link",{rel:"apple-touch-icon",href:g(l,120,120)}),(0,s.jsx)("link",{rel:"apple-touch-icon",sizes:"152x152",href:g(l,152,152)}),(0,s.jsx)("link",{rel:"apple-touch-icon",sizes:"167x167",href:g(l,167,167)}),(0,s.jsx)("link",{rel:"apple-touch-icon",sizes:"180x180",href:g(l,180,180)}),(0,s.jsx)("link",{rel:"mask-icon",href:(0,o.ZP)("favicons/safari-pinned-tab.svg"),color:"#6842ff"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,16,16),sizes:"16x16"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,32,32),sizes:"32x32"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,48,48),sizes:"48x48"}),(0,s.jsx)("link",{rel:"icon",type:"image/x-icon",href:g(h,196,196),sizes:"196x196"}),(0,s.jsx)("meta",{name:"msapplication-TileColor",content:"#603cba"}),(0,s.jsx)("meta",{name:"msapplication-TileImage",content:g(h,144,144)}),u]})};t.Z=c},23500:function(e,t,i){var s=i(32350),n=i(46413),r=i(44038);async function a(e){if(n.Z.isFullscreen())return;let t=e.currentUserInfo(),a=(0,r.T)(t?.device,!!window.__NEXT_DATA__.props.forceIpad,!!window.__NEXT_DATA__.props.forceAndroidTablet);if(a.isLowEndDevice)return;let o=await i.e(39883).then(i.bind(i,39883)),d=o.create(void 0,{resize:!0,useWorker:!0});d({particleCount:100,angle:60,spread:65,origin:{x:0},colors:s.eI,zIndex:1305}),d({particleCount:100,angle:120,spread:65,origin:{x:1},colors:s.eI,zIndex:1305})}t.Z=a},4235:function(e,t,i){i.d(t,{$:function(){return n},x:function(){return s}});let s="game-iframe";function n(){let e=document.getElementById(s);return e}},89041:function(e,t,i){var s=i(73359),n=i(37887),r=i(67294),a=i(89950),o=i(74040),d=i(63922),l=i(23180),h=i(46313),c=i(32184),u=i(46413);let m=e=>{let{gameId:t}=e,{user:i}=r.useContext(o.S),m=r.useContext(c.f),{openedDrawer:g}=r.useContext(l.rf),{drawerOpeningPending:f}=r.useContext(l.Xm),{openDrawer:p}=r.useContext(l.s9),[w,v]=(0,s.t)(d.bI),[b,C]=(0,s.t)(d.fo),[I,y]=(0,r.useState)(!1),[k,F]=(0,r.useState)(null),{data:T}=(0,n.a)(d.Qt,{skip:!i});(0,r.useEffect)(()=>{if(!f&&I&&k&&(i||g||(y(!1),F(null),k.postMessage({type:"showAuthPromptResponse",data:{error:{code:"userCancelled",message:"User cancelled the auth prompt"}}},"*")),i&&T&&!g)){y(!1),F(null);let e={type:"showAuthPromptResponse",data:{user:{id:T.me.id,username:`${T.me.username}`,profilePictureUrl:`${h.Z.Instance.data.images}${T.me.profile.avatar}`}}};k.postMessage(e,"*")}},[g,I,i,k,T,f]);let R=(0,r.useCallback)(async e=>{let s={type:"requestUserTokenResponse",data:{}};if(!i){s.data={error:{code:"userNotAuthenticated",message:"The user is not authenticated"}},e.postMessage(s,"*");return}if(v.loading)return;let n=await w({variables:{gameId:t},fetchPolicy:"network-only"}),r=n.data?.userToken;n.error||!r?(console.error("User token retrieve error",n.error),s.data={error:{code:"unexpectedError",message:"Failed to retrieve user token"}}):s.data={token:r.token,expiresIn:r.expiresIn},e.postMessage(s,"*")},[i,v.loading,w,t]),A=(0,r.useCallback)(async e=>{let s={type:"requestXsollaUserTokenResponse",data:{}};if(!i){s.data={error:{code:"userNotAuthenticated",message:"The user is not authenticated"}},e.postMessage(s,"*");return}if(C.loading)return;let n=await b({variables:{gameId:t},fetchPolicy:"network-only"}),r=n.data?.xsollaUserToken;if(n.error||!r){console.error("Xsolla user token retrieve error",n.error);let e=n.error?.graphQLErrors?.[0]?.extensions?.code,t=n.error?.graphQLErrors?.[0]?.message;e?s.data={error:{code:e,message:t||""}}:s.data={error:{code:"unexpectedError",message:"Failed to retrieve Xsolla user token"}}}else s.data={token:r.token,expiresIn:r.expiresIn};e.postMessage(s,"*")},[t,b,i,C.loading]);return(0,r.useEffect)(()=>{let e=e=>{let t=()=>{setTimeout(()=>{p("signIn"),y(!0),F(e.source),u.Z.removeFakeFullscreenListener(t)},100)};u.Z.isFakeFullscreen()?u.Z.addFakeFullscreenListener(t):(p("signIn"),y(!0),F(e.source))},t=e=>{let{score:t,encryptedScore:i}=e.data;m.addScore(t,i)},i=i=>{if(i.data&&i.data.type===a.V)switch(i.data.event){case"requestUserToken":R(i.source);break;case"requestXsollaUserToken":A(i.source);break;case"showAuthPrompt":e(i);break;case"addScore":t(i);break;default:return}};return window.addEventListener("message",i),function(){window.removeEventListener("message",i)}},[t,i,w,p,m,A,R]),null};t.Z=m},17670:function(e,t,i){i.d(t,{E8:function(){return a},HL:function(){return r},Mg:function(){return d},wS:function(){return o}});var s=i(12774),n=i(14646);let r=n.Dr,a=s.Qi,o=s.SD,d=s.mj},92975:function(e,t,i){var s=i(85893),n=i(67294),r=i(42257);t.Z=function(e){let t=t=>{let i=n.useContext(r.ZP);return(0,s.jsx)(e,{deviceType:i,...t})};return t}},69311:function(e,t,i){i.d(t,{FZ:function(){return a},I7:function(){return n},SZ:function(){return d},_c:function(){return s},nb:function(){return r},w8:function(){return o}});let s="forceGCResults",n=new Date(Date.UTC(2023,11,14,7)).getTime();function r(e){if(e&&e[s])return!0;let t=new Date().getTime();return t>=n}new Date(Date.UTC(2023,11,20)).getTime();let a="16562",o="crazy-roll-3d",d=3e5},46413:function(e,t){let i=new class{fakeFullscreenListeners=[];eventKeys=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"];isInFakeFullscreen=!1;removeFullscreenListener(e){this.eventKeys.forEach(t=>{document.removeEventListener(t,e)})}addFullscreenListener(e){this.eventKeys.forEach(t=>{document.addEventListener(t,e)})}addFakeFullscreenListener(e){this.fakeFullscreenListeners.push(e)}removeFakeFullscreenListener(e){this.fakeFullscreenListeners=this.fakeFullscreenListeners.filter(t=>t!==e)}isFullscreen(){let e=window.document;return!!(e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement)}isFakeFullscreen(){return this.isInFakeFullscreen}enteredFakeFullscreen(){this.isInFakeFullscreen||(this.isInFakeFullscreen=!0,this.fakeFullscreenListeners.forEach(e=>e()))}exitFakeFullscreen(){this.isInFakeFullscreen&&(this.isInFakeFullscreen=!1,this.fakeFullscreenListeners.forEach(e=>e()))}forceLockOrientation=async e=>{if(e&&"BOTH"!==e&&"screen"in window&&window.screen&&window.screen.orientation&&window.screen.orientation.lock)try{await window.screen.orientation.lock("PORTRAIT"===e?"portrait":"landscape")}catch(e){}};exitNativeFullscreen(){let e=window.document,t=e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen;return!!t&&(window.document.fullscreenElement&&t.call(e),!0)}};t.Z=i},44715:function(e,t,i){var s=i(85893),n=i(67294),r=i(67749);t.Z=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return e=>class extends n.Component{static async getInitialProps(i){let{trlService:s}=(0,r.b)(i);if(!i.req){let n=Promise.all(t.map(e=>s.loadTrlMessagesToLingui(e))),[r]=await Promise.all([e.getInitialProps?await e.getInitialProps(i):{},n]);return{...r}}let n=Promise.all(t.map(e=>s.getTrlMessages(e))),[a,o]=await Promise.all([e.getInitialProps?e.getInitialProps(i):Promise.resolve({}),n]),d=o.reduce((e,t)=>Object.assign(e,t));return{messages:d,...a}}render(){let{...t}=this.props;return(0,s.jsx)(e,{...t})}}}}}]);